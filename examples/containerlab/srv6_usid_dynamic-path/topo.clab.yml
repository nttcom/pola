name: dynamic-path
topology:
  kinds:
    xrd:
      image: ios-xr/xrd-control-plane:7.8.1
    juniper_vjunosrouter:
      image: vrnetlab/juniper_vjunos-router:24.2R1-S2.5
  nodes:
    pe01:
      kind: xrd
      startup-config: startup-configs/pe01.cfg
    pe02:
      kind: juniper_vjunosrouter
      startup-config: startup-configs/pe02.cfg
    p01:
      kind: xrd
      startup-config: startup-configs/p01.cfg
    p02:
      kind: xrd
      startup-config: startup-configs/p02.cfg
    pola:
      kind: linux
      image: golang:1.24.1
      binds:
        - bin/polad:/bin/polad
        - bin/pola:/bin/pola
        - polad/polad.yaml:/polad.yaml
        - sr-policies/pe02-policy1.yaml:/pe02-policy1.yaml
      exec:
        - apt update
        - apt install iproute2 -y
        - ip addr add 10.0.0.3/24 dev eth1
        - ip -6 addr add fd00::3/64 dev eth1
    gobgp:
      kind: linux
      image: golang:1.24.1
      binds:
        - bin/gobgpd:/bin/gobgpd
        - bin/gobgp:/bin/gobgp
        - gobgpd/gobgpd.yml:/gobgpd.yml
      exec:
        - apt update
        - apt install iproute2 -y
        - ip addr add 10.0.0.4/24 dev eth1
        - ip -6 addr add fd00::4/64 dev eth1
    switch:
      kind: bridge
  links:
    # SRv6 domain
    - endpoints: ["pe01:Gi0-0-0-0", "p01:Gi0-0-0-0"]
    - endpoints: ["pe01:Gi0-0-0-1", "p02:Gi0-0-0-0"]
    - endpoints: ["pe02:eth1", "p01:Gi0-0-0-1"]
    - endpoints: ["pe02:eth2", "p02:Gi0-0-0-1"]
    - endpoints: ["p01:Gi0-0-0-2", "p02:Gi0-0-0-2"]
    # Switch
    - endpoints: ["pe01:Gi0-0-0-2", "switch:eth1"]
    - endpoints: ["pe02:eth3", "switch:eth2"]
    - endpoints: ["pola:eth1", "switch:eth3"]
    - endpoints: ["gobgp:eth1", "switch:eth4"]
